import{a as w}from"./chunk-KNTEGQ2T.js";import{Ca as g,Da as T,Ha as o,Ia as s,J as I,Ja as h,Ka as x,La as m,Ma as p,Sa as y,Ta as a,U as d,V as u,Va as v,Xa as C,hb as E,ma as c,qa as S,ua as b,wa as f}from"./chunk-WCZZYUDQ.js";var _=class i{timer=Number(localStorage.getItem("time"))||300;setTimer(t){this.timer=t}getTime(){return this.timer}static \u0275fac=function(e){return new(e||i)};static \u0275prov=I({token:i,factory:i.\u0275fac,providedIn:"root"})};var D=(i,t)=>({"cursor-pointer":i,"cursor-not-allowed opacity-50":t}),N=(i,t)=>({"cursor-not-allowed":i,"cursor-pointer":t});function O(i,t){i&1&&a(0," Clique sobre o hor\xE1rio para altera-lo ")}function $(i,t){i&1&&a(0," Pare o timer para alterar o hor\xE1rio ")}function j(i,t){if(i&1){let e=x();o(0,"span",13),m("click",function(){d(e);let r=p();return u(!r.isTimerPlaying&&r.toggleEdit())}),a(1),s()}if(i&2){let e=p();g("ngClass",C(2,N,e.isTimerPlaying,!e.isTimerPlaying)),c(),v(" ",e.formattedTime," ")}}function A(i,t){if(i&1){let e=x();o(0,"div",6)(1,"input",14,0),m("keyup.enter",function(){d(e);let r=y(2),l=p();return u(l.setTimeManually(r.value))}),s(),o(3,"div",15)(4,"button",16),m("click",function(){d(e);let r=y(2),l=p();return u(l.setTimeManually(r.value))}),a(5,"Confirmar "),s(),o(6,"button",17),m("click",function(){d(e);let r=p();return u(r.toggleEdit())}),a(7,"Cancelar "),s()()()}if(i&2){let e=p();c(),g("value",e.formattedTime)}}function F(i,t){i&1&&(h(0,"img",18),o(1,"span",10),a(2,"Parar Timer"),s())}function R(i,t){i&1&&(h(0,"img",19),o(1,"span",10),a(2,"Iniciar Timer"),s())}var P=class i{constructor(t,e){this.timerService=t;this.soundService=e}timeInSeconds;selectedTime;audio;timer=null;isEditing=!1;isTimerPlaying=!1;isSoundPlaying=!1;ngOnInit(){this.timeInSeconds=this.timerService.getTime(),this.selectedTime=this.timeInSeconds,this.audio=new Audio(this.soundService.getSound().src)}ngOnDestroy(){this.stopTimer(),this.stopSound()}get formattedTime(){let t=Math.floor(this.timeInSeconds/3600),e=Math.floor(this.timeInSeconds%3600/60),n=this.timeInSeconds%60;return`${this.pad(t)}:${this.pad(e)}:${this.pad(n)}`}toggleEdit(){this.isEditing=!this.isEditing}setTimeManually(t){if(t=t.trim(),/[a-zA-Z]/.test(t)){this.timeInSeconds=this.selectedTime,this.setTimeVariables(),this.isEditing=!1;return}if(/^\d+$/.test(t)){let e=parseInt(t,10);isNaN(e)?(this.timeInSeconds=this.selectedTime,this.setTimeVariables()):(this.timeInSeconds=e,this.setTimeVariables()),this.isEditing=!1;return}if(t.includes(":")){let e=t.split(":").map(k=>parseInt(k,10)||0),n=0,r=0,l=0;e.length===3?[n,r,l]=e:e.length===2?[r,l]=e:e.length===1&&([l]=e),this.timeInSeconds=n*3600+r*60+l,this.setTimeVariables(),this.isEditing=!1;return}this.timeInSeconds=this.selectedTime,this.setTimeVariables(),this.isEditing=!1}start(){this.timer||this.timeInSeconds<=0||(this.timer=setInterval(()=>{this.timeInSeconds>0?(this.timeInSeconds--,this.timerService.setTimer(this.timeInSeconds),this.isTimerPlaying=!0):(this.stopTimer(),this.playSound(),this.isTimerPlaying=!1)},1e3))}reset(){this.stopTimer(),this.timeInSeconds=this.selectedTime,this.setTimeVariables(),this.audio.pause()}stopTimer(){clearInterval(this.timer),this.timer=null,this.isTimerPlaying=!1}stopSound(){this.audio.pause(),this.isSoundPlaying=!1}playSound(){this.isSoundPlaying=!0;let t=0,e=()=>{t<3?(this.audio.currentTime=0,this.audio.play(),t++):this.isSoundPlaying=!1};this.audio.addEventListener("ended",e,{once:!1}),e()}setTimeVariables(){this.selectedTime=this.timeInSeconds,this.timerService.setTimer(this.timeInSeconds),localStorage.setItem("time",this.timeInSeconds.toString())}pad(t){return t<10?`0${t}`:`${t}`}static \u0275fac=function(e){return new(e||i)(S(_),S(w))};static \u0275cmp=b({type:i,selectors:[["app-timer"]],decls:21,vars:7,consts:[["timeInput",""],[1,"w-full","h-full","flex","flex-col","gap-y-8","items-center","justify-center","p-2","sm:p-0","text-white"],[1,"text-center","flex","flex-col","gap-y-2"],[1,"font-bold","text-3xl"],[1,"text-sm"],[1,"text-5xl","font-mono","cursor-pointer","select-none",3,"ngClass"],[1,"flex","flex-col","items-center","gap-4"],[1,"flex","gap-8","mt-6"],[1,"tooltip",3,"click","ngClass"],["src","icons/stop.png","alt","Replay",1,"w-7","h-7"],[1,"tooltiptext","mt-1"],[1,"cursor-pointer","tooltip",3,"click"],["src","icons/replay.png","alt","Replay",1,"w-7","h-7"],[1,"text-5xl","font-mono","cursor-pointer","select-none",3,"click","ngClass"],["type","text",1,"text-3xl","font-mono","text-center","border","rounded","px-2","py-1","w-[70%]",3,"keyup.enter","value"],[1,"flex","gap-4"],[1,"px-4","py-2","rounded","bg-green-400","text-white","cursor-pointer","hover:bg-green-500","transition",3,"click"],[1,"px-4","py-2","rounded","bg-gray-400","text-white","cursor-pointer","hover:bg-gray-500","transition",3,"click"],["src","icons/pause.png","alt","Play",1,"w-7","h-7"],["src","icons/play.png","alt","Pause",1,"w-7","h-7"]],template:function(e,n){e&1&&(o(0,"main",1)(1,"div",2)(2,"h1",3),a(3,"Timer"),s(),o(4,"p",4),f(5,O,1,0)(6,$,1,0),s()(),f(7,j,2,5,"span",5)(8,A,8,1,"div",6),o(9,"div",7)(10,"button",8),m("click",function(){return n.stopSound()}),h(11,"img",9),o(12,"span",10),a(13,"Parar M\xFAsica"),s()(),o(14,"button",11),m("click",function(){return n.isTimerPlaying?n.stopTimer():n.start()}),f(15,F,3,0)(16,R,3,0),s(),o(17,"button",11),m("click",function(){return n.reset()}),h(18,"img",12),o(19,"span",10),a(20,"Resetar Timer"),s()()()()),e&2&&(c(5),T(n.isTimerPlaying?6:5),c(2),T(n.isEditing?8:7),c(3),g("ngClass",C(4,D,n.isSoundPlaying,!n.isSoundPlaying)),c(5),T(n.isTimerPlaying?15:16))},dependencies:[E],encapsulation:2})};export{P as TimerComponent};
